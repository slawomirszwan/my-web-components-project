konfiguracja vite obsÅ‚ugujÄ…ca wiele plikÃ³w punktu wejÅ›cia html



Aby skonfigurowaÄ‡ Vite do obsÅ‚ugi wielu plikÃ³w HTML jako punktÃ³w wejÅ›cia, 
moÅ¼emy uÅ¼yÄ‡ wtyczki vite-plugin-html 
lub po prostu skonfigurowaÄ‡ wiele punktÃ³w wejÅ›cia w konfiguracji Vite. 


Jednak Vite domyÅ›lnie obsÅ‚uguje tylko jeden plik HTML (index.html) w katalogu gÅ‚Ã³wnym. 
Aby mieÄ‡ wiele plikÃ³w HTML, musimy skonfigurowaÄ‡ wiele punktÃ³w wejÅ›cia.

Od Vite 2.x, moÅ¼emy skonfigurowaÄ‡ wiele punktÃ³w wejÅ›cia, 
ustawiajÄ…c opcjÄ™ build.rollupOptions.input jako obiekt, gdzie klucze to nazwy, a wartoÅ›ci to Å›cieÅ¼ki do plikÃ³w HTML.

Oto przykÅ‚adowa konfiguracja:

UmieÅ›Ä‡ swoje pliki HTML w katalogu projektu (np. w katalogu gÅ‚Ã³wnym lub w src). Dla przykÅ‚adu, zaÅ‚Ã³Å¼my, Å¼e mamy:

index.html
about.html
W pliku vite.config.js skonfiguruj wejÅ›cia:

javascript


import { defineConfig } from 'vite'
import { resolve } from 'path'

export default defineConfig({
  build: {
    rollupOptions: {
      input: {
        main: resolve(__dirname, 'index.html'),
        about: resolve(__dirname, 'about.html')
      }
    }
  }
})
JeÅ›li masz wiÄ™cej plikÃ³w, moÅ¼esz je dodaÄ‡ w podobny sposÃ³b.

Upewnij siÄ™, Å¼e w kaÅ¼dym pliku HTML masz odpowiednie odwoÅ‚ania do skryptÃ³w i stylÃ³w. Na przykÅ‚ad, w about.html powinno byÄ‡:

Ale jeÅ›li chcesz, aby Vite automatycznie wstrzykiwaÅ‚ skrypty, moÅ¼esz uÅ¼yÄ‡ tagu bez podawania src, ale wtedy musisz mieÄ‡ oddzielne pliki JS dla kaÅ¼dego punktu wejÅ›cia.

Alternatywnie, moÅ¼esz uÅ¼yÄ‡ wtyczki vite-plugin-html dla bardziej zaawansowanych funkcji, ale do podstawowych przypadkÃ³w wystarczy konfiguracja Rollup.

Uruchom vite build, a w katalogu dist otrzymasz skompilowane pliki dla kaÅ¼dego z punktÃ³w wejÅ›cia.

Uwaga: W trybie development, Vite domyÅ›lnie uruchamia siÄ™ z index.html. Aby uzyskaÄ‡ dostÄ™p do about.html, musisz przejÅ›Ä‡ bezpoÅ›rednio pod adres http://localhost:3000/about.html (lub inny port). Vite serwuje wszystkie pliki HTML w katalogu gÅ‚Ã³wnym.

JeÅ›li chcesz, aby w trybie development Vite automatycznie uruchamiaÅ‚ siÄ™ z wieloma serwerami lub przekierowaniami, to nie jest to standardowe zachowanie. MoÅ¼esz jednak skorzystaÄ‡ z wtyczki vite-plugin-html lub skonfigurowaÄ‡ serwer developmentowy, aby obsÅ‚ugiwaÅ‚ SPA (Single Page Application) z przekierowaniami, ale w przypadku wielu plikÃ³w HTML po prostu odwiedzasz bezpoÅ›rednio ich adresy.

JeÅ›li potrzebujesz, aby kaÅ¼dy plik HTML miaÅ‚ wÅ‚asny skrypt wejÅ›ciowy, upewnij siÄ™, Å¼e w kaÅ¼dym pliku HTML jest tag script z type="module", ktÃ³ry Å‚aduje odpowiedni plik JavaScript.

PrzykÅ‚ad struktury plikÃ³w:

index.html
about.html
src/
main.js (dla index.html)
about.js (dla about.html)
W index.html:

W about.html:

W vite.config.js, jak powyÅ¼ej.

To powinno dziaÅ‚aÄ‡.

Aby skonfigurowaÄ‡ Vite do obsÅ‚ugi wielu plikÃ³w HTML jako punktÃ³w wejÅ›cia, wykonaj nastÄ™pujÄ…ce kroki:

1. Struktura projektu
text

project-root/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ pages/
â”‚   â”‚   â”œâ”€â”€ index/
â”‚   â”‚   â”‚   â””â”€â”€ main.js
â”‚   â”‚   â””â”€â”€ about/
â”‚   â”‚       â””â”€â”€ main.js
â”œâ”€â”€ public/
â”‚   â””â”€â”€ shared-assets/
â”œâ”€â”€ index.html
â”œâ”€â”€ about.html
â””â”€â”€ vite.config.js
2. Konfiguracja Vite (vite.config.js)
JavaScript

import { defineConfig } from 'vite'
import { resolve } from 'path'

export default defineConfig({
  build: {
    rollupOptions: {
      input: {
        main: resolve(__dirname, 'index.html'),
        about: resolve(__dirname, 'about.html'),
        // Dodaj kolejne pliki HTML tutaj
      },
    },
  },
  server: {
    // Opcjonalnie: konfiguracja serwera deweloperskiego
    open: '/index.html', // OtwÃ³rz domyÅ›lny plik
  },
})
3. PrzykÅ‚adowe pliki HTML
index.html

HTML

<!DOCTYPE html>
<html lang="pl">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Strona GÅ‚Ã³wna</title>
  </head>
  <body>
    <div id="app"></div>
    <script type="module" src="/src/pages/index/main.js"></script>
  </body>
</html>
about.html

HTML

<!DOCTYPE html>
<html lang="pl">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>O Nas</title>
  </head>
  <body>
    <div id="app"></div>
    <script type="module" src="/src/pages/about/main.js"></script>
  </body>
</html>
4. Pliki JavaScript (opcjonalnie)
src/pages/index/main.js

JavaScript

import '/src/styles/index.css'

// Kod specyficzny dla strony gÅ‚Ã³wnej
console.log('Strona gÅ‚Ã³wna zaÅ‚adowana')
src/pages/about/main.js

JavaScript

import '/src/styles/about.css'

// Kod specyficzny dla strony "O nas"
console.log('Strona "O nas" zaÅ‚adowana')
5. Uruchomienie
Bash

# Development
npm run dev

# Build produkcyjny
npm run build
Kluczowe elementy konfiguracji:
Multi-entry build: Konfiguracja build.rollupOptions.input jako obiektu z Å›cieÅ¼kami do plikÃ³w HTML
Struktura katalogÃ³w: Oddzielne katalogi dla kaÅ¼dej strony z wÅ‚asnymi zasobami
WspÃ³Å‚dzielone zasoby: Pliki w katalogu public sÄ… serwowane pod rootem
Dodatkowe uwagi:
KaÅ¼dy plik HTML musi mieÄ‡ wÅ‚asny skrypt wejÅ›ciowy
MoÅ¼esz uÅ¼ywaÄ‡ wspÃ³lnych komponentÃ³w i stylÃ³w miÄ™dzy stronami
W trybie development wszystkie pliki HTML sÄ… dostÄ™pne pod ich bezpoÅ›rednimi adresami
Wersja produkcyjna generuje oddzielne bundlle dla kaÅ¼dej strony
Rozszerzenia konfiguracji:
UÅ¼yj resolve.alias dla lepszej obsÅ‚ugi Å›cieÅ¼ek
Dodaj plugin do preprocessingu HTML jeÅ›li potrzebujesz
Skonfiguruj osobne optymalizacje dla rÃ³Å¼nych stron
Ta konfiguracja pozwala na utrzymanie odseparowanych aplikacji/staw w ramach jednego projektu Vite z optymalizacjÄ… budowania i wspÃ³Å‚dzieleniem zasobÃ³w.





















wwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwww
Tak, moÅ¼na obsÅ‚uÅ¼yÄ‡ pliki HTML z folderu src/pages w Vite, ale wymaga to dodatkowej konfiguracji. Jest to praktyczne i stosowane, szczegÃ³lnie w projektach, ktÃ³re majÄ… wiele stron (tzw. multi-page application). Oto jak to zrobiÄ‡:

1. Zmiana struktury projektu
Przenosimy pliki HTML do folderu src/pages:



project-root/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ pages/
â”‚   â”‚   â”œâ”€â”€ index/
â”‚   â”‚   â”‚   â”œâ”€â”€ index.html
â”‚   â”‚   â”‚   â””â”€â”€ main.js
â”‚   â”‚   â””â”€â”€ about/
â”‚   â”‚       â”œâ”€â”€ about.html
â”‚   â”‚       â””â”€â”€ main.js
â”œâ”€â”€ public/
â”‚   â””â”€â”€ shared-assets/
â””â”€â”€ vite.config.js
2. Konfiguracja Vite (vite.config.js)
Musimy dynamicznie ustawiÄ‡ wejÅ›cia (input) dla Rollup na podstawie plikÃ³w HTML w src/pages. MoÅ¼emy to zrobiÄ‡ za pomocÄ… glob, na przykÅ‚ad przy uÅ¼yciu glob lub fast-glob.

Zainstaluj fast-glob:

bash


npm install --save-dev fast-glob
NastÄ™pnie w vite.config.js:

javascript


import { defineConfig } from 'vite'
import { resolve } from 'path'
import fg from 'fast-glob'

// Pobieramy wszystkie pliki HTML z folderu src/pages
const htmlFiles = fg.sync(['src/pages/**/*.html'])

// Tworzymy obiekt wejÅ›ciowy dla Rollup
const inputEntries = htmlFiles.reduce((entries, file) => {
  // Nazwa entry to Å›cieÅ¼ka wzglÄ™dem 'src/pages' bez rozszerzenia
  const name = file.replace('src/pages/', '').replace(/\.html$/, '')
  entries[name] = resolve(__dirname, file)
  return entries
}, {})

export default defineConfig({
  build: {
    rollupOptions: {
      input: inputEntries,
      // Opcjonalnie: ustawienie katalogu wyjÅ›ciowego dla assetÃ³w
      output: {
        assetFileNames: (assetInfo) => {
          let extType = assetInfo.name.split('.')[1]
          if (/png|jpe?g|svg|gif|tiff|bmp|ico/i.test(extType)) {
            extType = 'images'
          }
          return `assets/${extType}/[name]-[hash][extname]`
        },
        chunkFileNames: 'assets/js/[name]-[hash].js',
        entryFileNames: 'assets/js/[name]-[hash].js',
      },
    },
    // Ustawienie katalogu wyjÅ›ciowego na 'dist' (domyÅ›lnie) i czyszczenie
    outDir: 'dist',
    emptyOutDir: true,
  },
  server: {
    // Serwowanie z katalogu src/pages jako root
    open: '/index.html', // MoÅ¼esz zmieniÄ‡ na innÄ… stronÄ™ startowÄ…
  },
  // Ustawienie publicznego katalogu na 'public'
  publicDir: 'public',
})
```__
3. Dostosowanie Å›cieÅ¼ek w plikach HTML
W plikach HTML w src/pages musimy dostosowaÄ‡ Å›cieÅ¼ki do skryptÃ³w i zasobÃ³w. PoniewaÅ¼ pliki HTML sÄ… teraz w src/pages, a Vite serwuje z roota, moÅ¼emy uÅ¼ywaÄ‡ bezwzglÄ™dnych Å›cieÅ¼ek lub wzglÄ™dnych, ale trzeba wziÄ…Ä‡ pod uwagÄ™ strukturÄ™.

Na przykÅ‚ad w src/pages/index/index.html:

html


<!DOCTYPE html>
<html lang="pl">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Strona GÅ‚Ã³wna</title>
  </head>
  <body>
    <div id="app"></div>
    <!-- Skrypt jest w tym samym katalogu co HTML -->
    <script type="module" src="./main.js"></script>
  </body>
</html>
4. Uruchomienie
npm run dev - uruchomi serwer deweloperski. Pliki HTML bÄ™dÄ… dostÄ™pne pod Å›cieÅ¼kami zgodnymi z ich lokalizacjÄ… w src/pages. Na przykÅ‚ad:

Strona gÅ‚Ã³wna: http://localhost:3000/index/index.html (jeÅ›li mamy src/pages/index/index.html)
Strona about: http://localhost:3000/about/about.html (jeÅ›li mamy src/pages/about/about.html)
npm run build - zbuduje projekt do katalogu dist z zachowaniem struktury folderÃ³w.

5. Uproszczenie Å›cieÅ¼ek URL
JeÅ›li chcesz, aby strona gÅ‚Ã³wna byÅ‚a dostÄ™pna pod http://localhost:3000/index.html (bez podwÃ³jnego index), moÅ¼esz zmieniÄ‡ strukturÄ™ plikÃ³w:



src/
  pages/
    index.html
    about.html
    index/
      main.js
    about/
      main.js
Wtedy w index.html odwoÅ‚anie do skryptu bÄ™dzie: src="./index/main.js".

A w konfiguracji Vite, zmieÅ„ glob na ['src/pages/*.html'] i odpowiednio przetworz nazwy.*

Czy to praktyczne i stosowane?
Tak, takie podejÅ›cie jest praktyczne i stosowane w wielu projektach. Pozwala ono na:

ModularnoÅ›Ä‡: KaÅ¼da strona ma swÃ³j wÅ‚asny katalog z zasobami.
WspÃ³Å‚dzielenie zasobÃ³w: WspÃ³lne biblioteki i style moÅ¼na importowaÄ‡ w kaÅ¼dym entry point.
Åatwe zarzÄ…dzanie: Dodawanie nowych stron jest proste - wystarczy dodaÄ‡ nowy katalog z plikiem HTML i skryptem.
WadÄ… jest to, Å¼e w trybie deweloperskim URL mogÄ… byÄ‡ dÅ‚uÅ¼sze (ze wzglÄ™du na strukturÄ™ katalogÃ³w). MoÅ¼na to rozwiÄ…zaÄ‡ za pomocÄ… konfiguracji serwera deweloperskiego lub przez zmianÄ™ struktury plikÃ³w.

Alternatywne podejÅ›cie
Innym popularnym podejÅ›ciem jest trzymanie plikÃ³w HTML w katalogu gÅ‚Ã³wnym (obok src), a w src tylko skrypty i style. Wtedy konfiguracja jest prostsza, ale tracimy modularnoÅ›Ä‡ w obrÄ™bie src.

Ostatecznie, wybÃ³r zaleÅ¼y od preferencji i wymagaÅ„ projektu.

Tak, moÅ¼na obsÅ‚ugiwaÄ‡ pliki HTML z folderu src/pages i jest to praktyczne oraz stosowane w wielu projektach.

Konfiguracja Vite dla src/pages/
1. Struktura projektu
text

project-root/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ pages/
â”‚   â”‚   â”œâ”€â”€ home/
â”‚   â”‚   â”‚   â”œâ”€â”€ index.html
â”‚   â”‚   â”‚   â”œâ”€â”€ main.js
â”‚   â”‚   â”‚   â””â”€â”€ style.css
â”‚   â”‚   â”œâ”€â”€ about/
â”‚   â”‚   â”‚   â”œâ”€â”€ index.html
â”‚   â”‚   â”‚   â”œâ”€â”€ main.js
â”‚   â”‚   â”‚   â””â”€â”€ style.css
â”‚   â”‚   â””â”€â”€ contact/
â”‚   â”‚       â”œâ”€â”€ index.html
â”‚   â”‚       â”œâ”€â”€ main.js
â”‚   â”‚       â””â”€â”€ style.css
â”œâ”€â”€ public/
â”œâ”€â”€ package.json
â””â”€â”€ vite.config.js
2. Konfiguracja Vite (vite.config.js)
JavaScript

import { defineConfig } from 'vite'
import { resolve } from 'path'
import { glob } from 'glob'

// Dynamiczne znajdowanie wszystkich plikÃ³w HTML w src/pages
const htmlFiles = glob.sync('src/pages/**/*.html')

const inputEntries = {}
htmlFiles.forEach(file => {
  const name = file.replace('src/pages/', '').replace(/\.html$/, '')
  inputEntries[name] = resolve(__dirname, file)
})

export default defineConfig({
  build: {
    rollupOptions: {
      input: inputEntries,
      output: {
        // Organizacja output w folderze dist
        entryFileNames: 'assets/[name]-[hash].js',
        chunkFileNames: 'assets/[name]-[hash].js',
        assetFileNames: (assetInfo) => {
          const extType = assetInfo.name.split('.')[1]
          if (/png|jpe?g|svg|gif|tiff|bmp|ico/i.test(extType)) {
            return 'assets/images/[name]-[hash][extname]'
          }
          if (/css/i.test(extType)) {
            return 'assets/css/[name]-[hash][extname]'
          }
          return 'assets/[name]-[hash][extname]'
        }
      }
    },
    outDir: 'dist',
    emptyOutDir: true,
  },
  server: {
    open: '/home/index.html' // OtwÃ³rz domyÅ›lnÄ… stronÄ™
  },
  publicDir: 'public'
})
3. Alternatywna konfiguracja z rÄ™cznÄ… definicjÄ…
JavaScript

import { defineConfig } from 'vite'
import { resolve } from 'path'

export default defineConfig({
  build: {
    rollupOptions: {
      input: {
        'home/index': resolve(__dirname, 'src/pages/home/index.html'),
        'about/index': resolve(__dirname, 'src/pages/about/index.html'),
        'contact/index': resolve(__dirname, 'src/pages/contact/index.html'),
      }
    }
  }
})
PrzykÅ‚adowy plik HTML w src/pages/
src/pages/home/index.html

HTML

<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Strona GÅ‚Ã³wna</title>
</head>
<body>
  <div id="app">
    <h1>Witaj na stronie gÅ‚Ã³wnej</h1>
  </div>
  <script type="module" src="./main.js"></script>
</body>
</html>
Zalety umieszczania HTML w src/pages/
âœ… Praktyczne korzyÅ›ci:
Organizacja kodu - Wszystkie ÅºrÃ³dÅ‚a w jednym miejscu
Importowanie komponentÃ³w - Åatwe importowanie komponentÃ³w z src/
Hot Module Replacement - Lepsza integracja z HMR
Przetwarzanie przez Vite - HTML moÅ¼e byÄ‡ przetwarzany przez pluginy
Lepsza struktura projektu - Logiczne grupowanie stron
âœ… Popularne przypadki uÅ¼ycia:
Aplikacje multi-page (MPA)
Strony marketingowe z rÃ³Å¼nymi landing pages
Projekty z wieloma niezaleÅ¼nymi aplikacjami
Strony z rÃ³Å¼nymi tematami/stylami
Rozszerzona konfiguracja z pluginami
JavaScript

import { defineConfig } from 'vite'
import { resolve } from 'path'
import { createHtmlPlugin } from 'vite-plugin-html'

export default defineConfig({
  plugins: [
    createHtmlPlugin({
      minify: true,
      pages: [
        {
          entry: 'src/pages/home/main.js',
          filename: 'home/index.html',
          template: 'src/pages/home/index.html',
          injectOptions: {
            data: {
              title: 'Strona GÅ‚Ã³wna',
              injectScript: '<script>console.log("Home page")</script>',
            },
          },
        },
        {
          entry: 'src/pages/about/main.js',
          filename: 'about/index.html',
          template: 'src/pages/about/index.html',
        },
      ],
    }),
  ],
  build: {
    rollupOptions: {
      input: {
        home: resolve(__dirname, 'src/pages/home/index.html'),
        about: resolve(__dirname, 'src/pages/about/index.html'),
      }
    }
  }
})
Praktyczne uwagi
ğŸ¯ Kiedy warto uÅ¼ywaÄ‡ src/pages/:
Gdy masz wiele niezaleÅ¼nych stron
Gdy chcesz wspÃ³Å‚dzieliÄ‡ komponenty miÄ™dzy stronami
Gdy potrzebujesz przetwarzania HTML przez Vite
W projektach typu "design system" z wieloma przykÅ‚adami
âš ï¸ Kiedy lepiej uÅ¼ywaÄ‡ root HTML:
Bardzo proste projekty z 1-2 stronami
Gdy preferujesz tradycyjnÄ… strukturÄ™
Przy migracji starszych projektÃ³w
Podsumowanie
Umieszczanie HTML w src/pages/ jest caÅ‚kowicie praktyczne i czÄ™sto stosowane. 
To podejÅ›cie oferuje lepszÄ… organizacjÄ™ kodu i peÅ‚nÄ… integracjÄ™ z ekosystemem Vite. 
Wiele nowoczesnych frameworkÃ³w i starter kits uÅ¼ywa podobnej struktury dla aplikacji multi-page.

